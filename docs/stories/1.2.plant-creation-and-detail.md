# Story 1.2: Plant Creation and Basic Detail

## Status

Approved

## Story

**As a** beginner grower starting GroBro for the first time,  
**I want** to create my first plant with basic parameters and see a simple detail view,  
**so that** I feel the app understands my current grow and I have a clear place to manage it.

## Acceptance Criteria

1. From the root/Garden screen, the user can tap an action (e.g., “Create first plant” / “Add plant”) to start a creation flow.  
2. The plant creation flow collects at minimum:
   - Plant name  
   - Optional photo  
   - Stage (seedling/veg/flower)  
   - Pot size (liters)  
   - Substrate type (soil, coco, hydro, etc.)  
3. On saving, a `Plant` entity is created in the local store as per `data-model.md`.  
4. After creation, the user is navigated to a basic Plant Detail screen showing:
   - Photo (or placeholder)  
   - Name and stage  
   - Age (days since start)  
   - Pot size and substrate type  
5. If no plants exist, the Garden screen clearly prompts the user to create the first plant (empty state).  
6. All creation and navigation behavior works offline and persists across app restarts.

## Tasks / Subtasks

- [x] Implement `Plant` domain model and persistence mapping (AC: 2–4)
  - [x] Add `Plant` entity to Core Data model with fields from `data-model.md` (AC: 2–4)
  - [x] Create a Swift model/struct or wrapper for `Plant` in `Domain/Models/` (AC: 2–4)
  - [x] Implement `PlantStore` service in `Domain/Services/PlantStore.swift` for CRUD (AC: 3–4)
- [x] Implement plant creation UI (AC: 1–3,5–6)
  - [x] Add "Add plant" entry point on Garden (button or empty state CTA) (AC: 1,5)
  - [x] Build a SwiftUI form for plant creation with fields in AC 2 (AC: 2)
  - [x] On save, call `PlantStore` to persist the new plant and handle errors gracefully (AC: 3,6)
- [x] Implement basic Plant Detail screen (AC: 4)
  - [x] Add `PlantDetailView` and `PlantDetailViewModel` under `Features/PlantDetail/` (AC: 4)
  - [x] Show plant photo/placeholder, name, stage, age, pot size, substrate (AC: 4)
  - [x] Navigate from Garden card tap to `PlantDetailView` (AC: 4)

## Dev Notes

- Use the data model definitions in `docs/architecture/data-model.md` for `Plant` fields and enums (`PlantStage`, `SubstrateType`).  
- Garden should remain simple in this story: listing plants and providing navigation to detail is sufficient; no watering status yet.  
- Place:
  - Creation flow UI in `Features/Garden/` or a dedicated `Features/PlantCreation/` module (choose one and stay consistent).  
  - Detail view and view model in `Features/PlantDetail/`.  
- Keep `PlantStore` UI‑agnostic and testable.

### Testing

- Unit tests:
  - `PlantStore` can create, fetch, and delete plants using an in‑memory Core Data stack.  
  - Age calculation (days since `startDate`) is correct.  
- Manual checks:
  - Creating a plant from an empty Garden results in a visible card and navigable detail.  
  - Relaunching the app shows the plant still present.  
  - Creation and navigation work correctly without network connectivity.

## Change Log

| Date       | Version | Description                            | Author |
|-----------|---------|----------------------------------------|--------|
| 2025-11-14 | 0.1     | Initial story draft and approval       | PO/PM  |

## Dev Agent Record

### Agent Model Used

Claude Sonnet 4.5 (claude-sonnet-4-5-20250929)

### Debug Log References

None

### Completion Notes List

- Implemented complete Plant domain model with PlantStage and SubstrateType enums
- Created PlantEntity in Core Data with all required fields
- Built PlantStore service with full CRUD operations
- Developed plant creation flow with form validation
- Implemented Garden view with empty state and plant list
- Created detailed plant view showing all plant information
- Comprehensive unit tests for PlantStore (9 test cases)
- All components follow MVVM architecture and Swift 6 concurrency

### File List

**Domain Models:**
- GroBroPackage/Sources/GroBroDomain/Models/Plant.swift
- GroBroPackage/Sources/GroBroDomain/Models/PlantStage.swift
- GroBroPackage/Sources/GroBroDomain/Models/SubstrateType.swift

**Persistence:**
- GroBroPackage/Sources/GroBroPersistence/GroBroModel.xcdatamodeld/GroBroModel.xcdatamodel/contents
- GroBroPackage/Sources/GroBroPersistence/PlantEntity+CoreDataClass.swift
- GroBroPackage/Sources/GroBroPersistence/PlantEntity+CoreDataProperties.swift

**Services:**
- GroBroPackage/Sources/GroBroDomain/Services/PlantStore.swift

**Features:**
- GroBroPackage/Sources/GroBroFeature/Garden/GardenView.swift
- GroBroPackage/Sources/GroBroFeature/Garden/GardenViewModel.swift
- GroBroPackage/Sources/GroBroFeature/PlantCreation/PlantCreationView.swift
- GroBroPackage/Sources/GroBroFeature/PlantCreation/PlantCreationViewModel.swift
- GroBroPackage/Sources/GroBroFeature/PlantDetail/PlantDetailView.swift
- GroBroPackage/Sources/GroBroFeature/PlantDetail/PlantDetailViewModel.swift
- GroBroPackage/Sources/GroBroFeature/ContentView.swift

**App:**
- GroBro/GroBroApp.swift

**Tests:**
- GroBroPackage/Tests/GroBroDomainTests/PlantStoreTests.swift

**Config:**
- GroBroPackage/Package.swift

